@{
    var html = ViewData["HtmlContent"] as string ?? "";
    var delay = (int)(ViewData["Delay"] ?? 2000);
}

<div id="newsletter-popup" style="display:none;">
  <div class="popup-container">
    <button id="close-popup">✕</button>
    @Html.Raw(html)
    <form method="post" action="/subscribenewsletter" class="mt-3">
      <input type="email" name="email" placeholder="Το email σου" required style="width:100%; padding:10px; margin-bottom:10px;" />
      <button type="submit" style="width:100%; padding:10px;">Εγγραφή</button>
    </form>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  try {
    if (!localStorage.getItem('newsletter_shown')) {
      setTimeout(function() {
        var el = document.getElementById('newsletter-popup');
        if (el) el.style.display = 'flex';
      }, @delay);
      localStorage.setItem('newsletter_shown', 'true');
    }
    var closeBtn = document.getElementById('close-popup');
    if (closeBtn) closeBtn.addEventListener('click', function() {
      var el = document.getElementById('newsletter-popup');
      if (el) el.style.display = 'none';
    });
  } catch(e) { console && console.error(e); }
});
</script>

<style>
#newsletter-popup {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  display:none;
  align-items:center;
  justify-content:center;
  background: rgba(0,0,0,0.6);
  z-index: 9999;
}
.popup-container {
  background:#fff;
  border-radius:10px;
  padding:20px;
  max-width:450px;
  width:90%;
  position:relative;
}
#close-popup {
  position:absolute;
  top:10px; right:10px;
  border:none; background:none;
  font-size:18px;
}
</style>
